/* empty css              */(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const B=document.getElementById("step1"),I=document.getElementById("step2"),h=document.getElementById("success"),D=document.getElementById("inviterForm"),m=document.getElementById("prevBtn"),c=document.getElementById("nextBtn"),d=document.getElementById("submitBtn"),P=document.getElementById("loading"),_=document.getElementById("error"),M=document.getElementById("mainContent"),J=document.getElementById("errorMessage"),q=document.querySelectorAll(".tab-btn"),$=document.querySelectorAll(".tab-pane"),S=document.querySelector(".progress-step"),k=document.querySelector(".progress-percentage"),w=document.querySelector(".progress-fill"),L=document.querySelector(".progress-label"),U=document.querySelectorAll(".progress-marker"),x=document.getElementById("debugStep"),C=document.getElementById("debugTotal"),T=document.getElementById("debugProgress");let u=1,i="basic";const O=[{id:1,name:"basic",label:"Temel Bilgiler",progress:17},{id:2,name:"work",label:"İş Bilgileri",progress:33},{id:3,name:"personal",label:"Kişisel Özellikler",progress:50},{id:4,name:"social",label:"Sosyal ve Networking",progress:67},{id:5,name:"experience",label:"Deneyim",progress:83},{id:6,name:"future",label:"Gelecek",progress:100}],v="https://kprqdwwjywxtkariwjyd.supabase.co",y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtwcnFkd3dqeXd4dGthcml3anlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4MDYxMjYsImV4cCI6MjA3MTM4MjEyNn0.fuxy0dHa0D-DqyCopteghMn_HMrFagPm1NDMQF-29Uk";document.addEventListener("DOMContentLoaded",function(){K(),F(),N(),Y()});async function Y(){try{const e=E();if(!e){g("Davet token bulunamadı");return}console.log("🔍 Davet token doğrulanıyor:",e);const t=await fetch(`${v}/functions/v1/invite-verify`,{method:"POST",headers:{"Content-Type":"application/json",apikey:y,authorization:`Bearer ${y}`},body:JSON.stringify({token:e})});if(t.ok){const n=await t.json();n.ok!==!1?(G(),console.log("✅ Davet token doğrulandı")):g(n.reason==="not_found"?"Davet bağlantısı bulunamadı":"Davet bağlantısı geçersiz")}else{const n=await t.json();g(n.error||"Token doğrulanamadı")}}catch(e){console.error("Token doğrulama hatası:",e),g("Davet bağlantısı doğrulanamadı: "+e.message)}}function G(){P.style.display="none",_.style.display="none",M.style.display="block"}function g(e){P.style.display="none",_.style.display="block",M.style.display="none",J.textContent=e}function K(){D.addEventListener("submit",V),m&&m.addEventListener("click",X),c&&c.addEventListener("click",R),d&&d.addEventListener("click",W),q.forEach(n=>{n.addEventListener("click",()=>l(n.dataset.tab))});const e=document.getElementById("closeness");e&&e.addEventListener("input",F),document.querySelectorAll(".category-btn").forEach(n=>{n.addEventListener("click",()=>H(n.dataset.category))})}function V(e){e.preventDefault();const t=new FormData(D),n={first_name:t.get("inviterFirstName"),last_name:t.get("inviterLastName"),email:t.get("inviterEmail")};re(n)}function b(e){B.classList.remove("active"),I.classList.remove("active"),h.classList.remove("active"),e===1?(B.classList.add("active"),u=1):e===2?(I.classList.add("active"),u=2,A(),f(2)):e==="success"&&(h.classList.add("active"),u="success",f(6))}function X(){u===2&&(b(1),f(1))}function R(){i==="basic"?l("work"):i==="work"?l("personal"):i==="personal"?l("social"):i==="social"?l("experience"):i==="experience"&&(l("future"),Z())}function l(e){q.forEach(t=>{t.classList.remove("active"),t.dataset.tab===e&&t.classList.add("active")}),$.forEach(t=>{t.classList.remove("active"),t.id===e&&t.classList.add("active")}),i=e,A(),Q(e)}function A(){i==="basic"?(m.style.display="block",c.style.display="block",d.style.display="none"):i==="future"?(m.style.display="block",c.style.display="none",d.style.display="block"):(m.style.display="block",c.style.display="block",d.style.display="none")}function Z(){d.style.display="block",c.style.display="none"}function F(){const e=document.getElementById("closeness"),t=document.querySelector(".closeness-value");t&&e&&(t.textContent=e.value)}function H(e){document.querySelectorAll(".category-btn").forEach(n=>{n.classList.remove("active"),n.dataset.category===e&&n.classList.add("active")})}function f(e){const t=O.find(n=>n.id===e);t&&(S&&(S.textContent=`Adım ${e}/6`),k&&(k.textContent=`${t.progress}% Tamamlandı`),w&&(w.style.width=`${t.progress}%`),L&&(L.textContent=t.label),U.forEach((n,r)=>{r<e?n.classList.add("active"):n.classList.remove("active")}),N())}function Q(e){const n={basic:1,work:2,personal:3,social:4,experience:5,future:6}[e];n&&f(n)}function N(){x&&(x.textContent=u),C&&(C.textContent=6);const e=O.find(t=>t.id===u);T&&e&&(T.textContent=`${e.progress}%`)}async function W(){try{const e=ee();if(!se(e)){alert("Lütfen zorunlu alanları doldurun.");return}const t=document.getElementById("submitBtn"),n=t.textContent;t.textContent="Gönderiliyor...",t.disabled=!0;const r=window.inviteData;if(!r)throw new Error("Davet bilgileri bulunamadı");const o=E(),s=await fetch(`${v}/functions/v1/invite-submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o,inviter_contact_id:r.inviter_contact_id,contact:e})});if(s.ok){const a=await s.json();if(a.ok)j("Kişi başarıyla eklendi!"),setTimeout(()=>{b("success")},1500);else throw new Error(a.error||"Kişi eklenemedi")}else{const a=await s.json();throw new Error(a.error||"API error")}}catch(e){console.error("Submit error:",e),p("Gönderim sırasında hata oluştu: "+e.message)}finally{const e=document.getElementById("submitBtn");e.textContent=originalText,e.disabled=!1}}function ee(){const e={first_name:document.getElementById("firstName")?.value?.trim()||"",last_name:document.getElementById("lastName")?.value?.trim()||"",age:document.getElementById("age")?.value||"",city:document.getElementById("city")?.value||"",current_city:document.getElementById("currentCity")?.value||"",university:document.getElementById("university")?.value||"",department:document.getElementById("department")?.value||"",degree:document.getElementById("degree")?.value||"",graduation_year:document.getElementById("graduationYear")?.value||"",position:document.getElementById("currentTitle")?.value||"",company:document.getElementById("currentCompany")?.value||"",sectors:document.getElementById("sectors")?.value||"",expertise_tags:document.getElementById("expertiseTags")?.value||"",service_tags:document.getElementById("serviceTags")?.value||"",closeness:document.getElementById("closeness")?.value||5,category:te(),traits:ne(),principles:oe(),goals:document.getElementById("goals")?.value||"",vision:document.getElementById("vision")?.value||"",languages:document.getElementById("languages")?.value||"",mentor_service:document.getElementById("isMentor")?.checked||!1,social_volunteer:document.getElementById("volunteering")?.value||"",life_experience:document.getElementById("turningPoints")?.value||"",challenges:document.getElementById("bigChallenges")?.value||"",lessons:document.getElementById("bigLessons")?.value||"",future_goals:document.getElementById("goals5y")?.value||"",investment_interest:document.getElementById("willingToInvest")?.checked||!1,collaboration_areas:document.getElementById("collaborationAreas")?.value||""};return console.log("📝 Form verileri:",e),e}function te(){const e=document.querySelector(".category-btn.active");return e?e.dataset.category:""}function ne(){const e=[];return document.querySelectorAll('input[name="traits"]:checked').forEach(t=>{e.push(t.value)}),e}function oe(){const e=[];return document.querySelectorAll('input[name="principles"]:checked').forEach(t=>{e.push(t.value)}),e}function se(e){if(!e.first_name||e.first_name.length<2){const r=document.getElementById("firstName");return r&&(r.classList.add("input-error"),r.addEventListener("input",()=>r.classList.remove("input-error"),{once:!0})),!1}const t=document.getElementById("email"),n=document.getElementById("phone");return t&&n&&(t.value&&t.value.trim()||n.value&&n.value.trim()||(t.classList.add("input-warn"),n.classList.add("input-warn"),setTimeout(()=>{t.classList.remove("input-warn"),n.classList.remove("input-warn")},2500))),!0}function E(){return new URLSearchParams(window.location.search).get("t")}async function re(e){try{const t=document.querySelector('#inviterForm button[type="submit"]'),n=t.textContent;t.textContent="Doğrulanıyor...",t.disabled=!0;const r=E(),o=await fetch(`${v}/functions/v1/invite-verify`,{method:"POST",headers:{"Content-Type":"application/json",apikey:y,authorization:`Bearer ${y}`},body:JSON.stringify({token:r,inviter:e})});if(o.ok){const s=await o.json();if(s.ok)window.inviteData=s,j("Doğrulama başarılı! İkinci adıma geçiliyor..."),setTimeout(()=>{b(2)},1500);else{let a="Bu bilgilerle ağ listesinde kişi bulunamadı.";s.reason==="ambiguous"&&(a="Birden fazla eşleşen kişi bulundu. Lütfen e-posta adresinizi de girin."),p(a)}}else{const s=await o.json();throw new Error(s.error||"API error")}}catch(t){console.error("Validation error:",t),p("Doğrulama sırasında hata oluştu: "+t.message)}finally{const t=document.querySelector('#inviterForm button[type="submit"]');t.textContent=originalText,t.disabled=!1}}function j(e){const t=document.createElement("div");t.className="message success-message",t.textContent=e;const n=document.getElementById("inviterForm");n.insertBefore(t,n.firstChild),setTimeout(()=>{t.remove()},3e3)}function p(e){const t=document.createElement("div");t.className="message error-message",t.textContent=e;const n=document.getElementById("inviterForm");n.insertBefore(t,n.firstChild),setTimeout(()=>{t.remove()},5e3)}const z=document.createElement("style");z.textContent=`
    .message {
        padding: 12px 16px;
        border-radius: 8px;
        margin-bottom: 16px;
        font-weight: 500;
    }
    
    .success-message {
        background: #d1fae5;
        color: #065f46;
        border: 1px solid #a7f3d0;
    }
    
    .error-message {
        background: #fee2e2;
        color: #991b1b;
        border: 1px solid #fecaca;
    }
`;document.head.appendChild(z);
